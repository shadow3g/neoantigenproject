install.packages("BiocManager")
BiocManager::install()
BiocManager::install(c("ShortRead"))
ls
library(ShortRead)
fl <- system.file(package="ShortRead", "extdata", "E-MTAB-1147",
"ERR127302_1_subset.fastq.gz")
reads <- readFastq(fl)
reads
fqFile
fqFile<- FastqFile(fl)
fqFile
library(Biostrings)
library(Biostrings)
# --------------
# Date:  2019-11-10 19:13:51
# Author:JijunYu
# Email: jijunyu140@gmail.com
# --------------
# About project: This script change the format of ligands_all.file
#
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
file_list = list.files(ligands)
file_list
library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
a
s
s$`uniprot|A8KA43 227 KRFGKAYNL B2705`
s$`uniprot|A8KA43 227 KRFGKAYNL B2705`
s$`uniprot|A8KA43 227 KRFGKAYNL B2705`
s$`uniprot|Q9H3H0 171 IEHVIIPRI B4901`
MSGKDRIEIFPSRMAQTIMKARLKGAQTGRNLLKKKSDALTLRFRQILKKIIETKMLMGE
length("MSGKDRIEIFPSRMAQTIMKARLKGAQTGRNLLKKKSDALTLRFRQILKKIIETKMLMGE
VMREAAFSLAEAKFTAGDFSTTVIQNVNKAQVKIRAKKDNVAGVTLPVFEHYHEGTDSYE
LTGLARGGEQLAKLKRNYAKAVELLVELASLQTSFVTLDEAIKIXNRRVNAIEHVIIPRI
ERTLAYIITELDEREREEFYRLKKIQEKKKILKEKSEKDLEQRRAAGEVLEPANLLAEEK
DEDLLFE")
library(seqinr)
install.packages("seqinr")
library(seqinr); fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fastafile
fastafile$`uniprot|A8KA43`
fastafile$`uniprot|A8KA43`$name
fastafile$`uniprot|A8KA43`@name
Annot(fastafile$`uniprot|A8KA43`)
names(fastafile)
length(ncrna)
length(fastafile)
getAnnot(fastafile)
#library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_annno = getAnnot(fastafile)
fasta_anno = getAnnot(fastafile)
fasta_anno
length(fasta_anno)
fasta_anno[[1]]
anno_i = fasta_anno[[1]]
anno_i = gsub(" ","\t", anno_i)
anno_i
str_i_split = str_split(anno_i, "\t")
str_i_split
#library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
fastafile$`uniprot|A8KA43`
seq(1, length(fasta_anno))
for(i in seq(1, length(fasta_anno))[1:3]){
print(i)
anno_i = fasta_anno[[1]]
anno_i = gsub(" ","\t", anno_i)
str_i_split = str_split(anno_i, "\t")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[1]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[1]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = "\t")
}
}
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))[1:3]){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub(" ","\t", anno_i)
str_i_split = str_split(anno_i, "\t")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = "\t")
}
}
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))[640:660]){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub(" ","\t", anno_i)
str_i_split = str_split(anno_i, "\t")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = "\t")
}
}
i =650
length(str_i_split)==4
anno_i = fasta_anno[[i]]
anno_i = gsub(" ","\t", anno_i)
anno_i
anno_i = gsub(" ","\t", anno_i)
paste(anno_i,"HLA-D",collapse = "\t")
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))[640:660]){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub(" ","\t", anno_i)
str_i_split = str_split(anno_i, "\t")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = "\t")
print(fasta_anno[[i]])
}
}
fastafile$`uniprot|A8KA43`
getAnnot(fastafile) <- fasta_anno
fasta_sequence <- getSequence(fastafile)
fasta_sequence
fasta_sequence <- getSequence(fastafile)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta"))
paste(ligands,"Ligand_HLA-allformat.fasta")
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub(" ","\t", anno_i)
str_i_split = str_split(anno_i, "\t")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = "\t")
print(fasta_anno[[i]])
}
}
fasta_anno
fasta_sequence <- getSequence(fastafile)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"))
?write.fasta
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = inf)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = Inf)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = 10000)
# --------------
# Date:  2019-10-30 12:00:55
# Author:JijunYu
# Email: jijunyu140@gmail.com
# --------------
# About project:
#
library(seqinr)
file_list[4]
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
####################
# A/B
file_list = list.files(ligands)
file_list
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
fastafile<-read.fasta(paste(ligands,file_list[5],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
fasta_anno
str_split(">>gi|416115|gb|AAA03229.1 230 SAYGEPRKL HLA-C w1601")
str_split(">>gi|416115|gb|AAA03229.1 230 SAYGEPRKL HLA-C w1601","\t")
str_split(">>gi|416115|gb|AAA03229.1 230 SAYGEPRKL HLA-C w1601"," ")
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub("\t"," ", anno_i)
str_i_split = str_split(anno_i, " ")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-D",collapse = " ")
print(fasta_anno[[i]])
}
}
fasta_sequence <- getSequence(fastafile)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = 10000)
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
fastafile<-read.fasta(paste(ligands,file_list[5],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
fasta_anno
unlist(fasta_anno)
is.vector(unlist(fasta_anno))
fasta_anno_unlist = unlist(fasta_anno)
str_slit_fixed(fasta_anno_unlist," ",5)
file_A = which(str_locate(df_AandB$X4, "^A")[,1] == 1)
str_split_fixed(fasta_anno_unlist," ",5)
tail(str_split_fixed(fasta_anno_unlist," ",5))
anno_matrix <- str_split_fixed(fasta_anno_unlist," ",5)
anno_matrix_statis <- anno_matrix %>%
group_by() %>%
count()
colnames(anno_matrix)
colnames(anno_matrix) <- c(paste0("V",seq(1,5)))
anno_matrix_statis <- anno_matrix %>%
group_by(c("V4","V5")) %>%
count()
anno_matrix_statis <- anno_matrix %>%
group_by(c("V4","V5")) %>%
summarise(count = n())
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(c("V4","V5")) %>%
summarise(count = n())
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(c("V4")) %>%
summarise(count = n())
anno_matrix_statis
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(V4) %>%
summarise(count = n())
anno_matrix_statis
class(anno_matrix_statis)
colnames(anno_matrix_statis) <- c("HLA Type","Count")
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "/t",quote = F,row.names = F)
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
tail(anno_matrix_dataframe)
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(c(V4,V5)) %>%
summarise(count = n())
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- 0
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(c(V4,V5)) %>%
summarise(count = n())
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- 0
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(c(V4,V5)) %>%
summarise(count = n())
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- 0
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(c("V4","V5")) %>%
summarise(count = n())
?group_by
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- 0
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
anno_matrix_statis
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_statis <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
anno_matrix_statis
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_symmary) <- c("HLA Type","HLA Allele","Count")
write.table(anno_matrix_symmary,file = paste(ligands,"Ligand_HLA_symmary.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_summary) <- c("HLA Type","HLA Allele","Count")
write.table(anno_matrix_summary,file = paste(ligands,"Ligand_HLA_summary.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
anno_matrix_statis$Species <- "Human"
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
anno_matrix_statis <- anno_matrix_statis[c(4,1,2,3)]
head(anno_matrix_statis)
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(V4) %>%
summarise(count = n())
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(4,1,2,3)]
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(3,1,2)]
head(anno_matrix_statis)
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(3,1,2)]
head(anno_matrix_statis)
colnames(anno_matrix_statis)
colnames(anno_matrix_statis)[1]
colnames(anno_matrix_statis)[1] <- "Species"
#basic statistic
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(V4) %>%
summarise(count = n())
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(3,1,2)]
colnames(anno_matrix_statis)[1] <- "Species"
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_summary) <- c("HLA Type","HLA Allele","Count")
anno_matrix_summary$Species <- "Human"
anno_matrix_summary <- anno_matrix_summary[c(3,1,2)]
colnames(anno_matrix_summary)[1] <- "Species"
head(anno_matrix_summary)
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_summary) <- c("HLA Type","HLA Allele","Count")
anno_matrix_summary$Species <- "Human"
anno_matrix_summary <- anno_matrix_summary[c(4,1,2,3)]
colnames(anno_matrix_summary)[1] <- "Species"
write.table(anno_matrix_summary,file = paste(ligands,"Ligand_HLA_summary.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
file_list[4]
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
####################
#library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub("\t"," ", anno_i)
str_i_split = str_split(anno_i, " ")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-G",collapse = " ")
print(fasta_anno[[i]])
}
}
fasta_sequence <- getSequence(fastafile)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = 10000)
require(dplyr)
require(readtext)
require(stringi)
require(stringr)
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
file_list = list.files(ligands)
fastafile<-read.fasta(paste(ligands,file_list[5],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
fasta_anno_unlist = unlist(fasta_anno)
anno_matrix <- str_split_fixed(fasta_anno_unlist," ",5)
colnames(anno_matrix) <- c(paste0("V",seq(1,5)))
#basic statistic
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(V4) %>%
summarise(count = n())
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(3,1,2)]
colnames(anno_matrix_statis)[1] <- "Species"
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_summary) <- c("HLA Type","HLA Allele","Count")
anno_matrix_summary$Species <- "Human"
anno_matrix_summary <- anno_matrix_summary[c(4,1,2,3)]
colnames(anno_matrix_summary)[1] <- "Species"
write.table(anno_matrix_summary,file = paste(ligands,"Ligand_HLA_summary.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
####################
#library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
file_list[4]
# --------------
# Date:  2019-11-10 19:13:51
# Author:JijunYu
# Email: jijunyu140@gmail.com
# --------------
# About project: This script change the format of ligands_all.file
#
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
#library(Biostrings) ;s = readDNAStringSet(paste(ligands,file_list[4],sep = "/"))
library(seqinr)
fastafile<-read.fasta(paste(ligands,file_list[4],sep = "/"), seqtype = "AA",as.string = TRUE)
file_list
library(seqinr)
file_list
fastafile<-read.fasta(paste(ligands,file_list[2],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
for(i in seq(1, length(fasta_anno))){
print(i)
anno_i = fasta_anno[[i]]
anno_i = gsub("\t"," ", anno_i)
str_i_split = str_split(anno_i, " ")[[1]]
if (length(str_i_split)==4){
str_i_split_4 = str_split(str_i_split[4],"",n=2)
str_i_split_4_revision = paste0("HLA-",str_i_split_4[[1]][1],sep="")
str_i_split_5 = str_i_split_4[[1]][2]
fasta_anno[[i]] = paste(str_i_split[1],str_i_split[2],str_i_split[3],str_i_split_4_revision,str_i_split_5,collapse ="\t")
print(fasta_anno[[i]])
}else{
fasta_anno[[i]] = paste(anno_i,"HLA-G",collapse = " ")
print(fasta_anno[[i]])
}
}
fasta_sequence <- getSequence(fastafile)
write.fasta(fasta_sequence, fasta_anno, paste(ligands,"Ligand_HLA-allformat.fasta",sep = "/"),nbchar = 10000)
require(dplyr)
require(readtext)
require(stringi)
require(stringr)
#####parameter######
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
file_list = list.files(ligands)
file_list
basic_path = "./data_project"
ligands = paste(basic_path,"Ligands/revision_data",sep = "/")
file_list = list.files(ligands)
fastafile<-read.fasta(paste(ligands,file_list[5],sep = "/"), seqtype = "AA",as.string = TRUE)
fasta_anno = getAnnot(fastafile)
fasta_anno_unlist = unlist(fasta_anno)
anno_matrix <- str_split_fixed(fasta_anno_unlist," ",5)
colnames(anno_matrix) <- c(paste0("V",seq(1,5)))
#basic statistic
anno_matrix_statis <- as.data.frame(anno_matrix) %>%
group_by(V4) %>%
summarise(count = n())
#Output of basic statistic
colnames(anno_matrix_statis) <- c("HLA Type","Count")
anno_matrix_statis$Species <- "Human"
anno_matrix_statis <- anno_matrix_statis[c(3,1,2)]
colnames(anno_matrix_statis)[1] <- "Species"
write.table(anno_matrix_statis,file = paste(ligands,"Ligand_HLA_statistic.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
#detail statistic
anno_matrix_dataframe <- as.data.frame(anno_matrix)
anno_matrix_dataframe[is.na(anno_matrix_dataframe)] <- NULL
anno_matrix_summary <- anno_matrix_dataframe %>%
group_by(V4,V5) %>%
summarise(count = n())
colnames(anno_matrix_summary) <- c("HLA Type","HLA Allele","Count")
anno_matrix_summary$Species <- "Human"
anno_matrix_summary <- anno_matrix_summary[c(4,1,2,3)]
colnames(anno_matrix_summary)[1] <- "Species"
write.table(anno_matrix_summary,file = paste(ligands,"Ligand_HLA_summary.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
