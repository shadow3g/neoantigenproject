read.table('./data-raw/IEDB_MHC_Ligand_Homo.txt',sep = "\t",quote = "")
usethis::use_data(IEDB_MHC_Ligand)
IEDB_MHC_Ligand <-
read.table('./data-raw/IEDB_MHC_Ligand_Homo.txt',sep = "\t",quote = "")
usethis::use_data(IEDB_MHC_Ligand,overwrite = T)
IEDB_MHC_Ligand <-
read.table('./data-raw/IEDB_MHC_Ligand_Homo.txt',sep = "\t",quote = "")
View(IEDB_MHC_Ligand)
usethis::use_data(IEDB_MHC_Ligand,overwrite = T)
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/IEDB_MHC_Ligand.rda")
View(IEDB_MHC_Ligand)
unique(IEDB_MHC_Ligand$V36)
unique(Quantitative measurement)
unique(IEDB_MHC_Ligand$V37)
unique(IEDB_MHC_Ligand$V38)
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/IEDB_Tcell.rda")
View(IEDB_Tcell)
IEDB_Tcell[2,]
unname(nulist(IEDB_Tcell[2,]))
unname(unlist(IEDB_Tcell[2,]))
unname(unlist(IEDB_Tcell[2,]))
View(IEDB_Tcell)
IEDB_MHC_Ligand$V73
IEDB_Tcell$V73
View(IEDB_MHC_Ligand)
View(IEDB_Tcell)
IEDB_Tcell$V71
unique(IEDB_Tcell$V71)
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/IEDB_Tcell.rda")
View(IEDB_Tcell)
IEDB_Tcell[1,]
IEDB_Tcell[2,]
unique(IEDB_Tcell$V71
)
CNRD_MHC_Ligand <-
read.table('./datq-raw/mhc_ligand_full_CNRD.csv',sep = "\t",header = T,fill = T,comment.char = "")
getwsd()
getwd()
CNRD_MHC_Ligand <-
read.table('./data-raw/mhc_ligand_full_CNRD.csv',sep = "\t",header = T,fill = T,comment.char = "")
CNRD_MHC_Ligand <-
read.table('./data-raw/mhc_ligand_full_CNRD.csv',sep = "\t",header = T,fill = T,comment.char = "")
View(CNRD_MHC_Ligand)
CNRD_MHC_Ligand <-
read.table('./data-raw/mhc_ligand_full_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
View(CNRD_MHC_Ligand)
CNRD_MHC_Ligand <-
read.delim('./data-raw/mhc_ligand_full_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
View(CNRD_MHC_Ligand)
CNRD_MHC_Neoantigen <-
read.delim('./data-raw/Neoantigen_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
rm(list =CNRD_MHC_Neoantigen )
CNRD_MHC_Ligand <-
read.delim('./data-raw/mhc_ligand_full_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
usethis::use_data(CNRD_MHC_Ligand,overwrite = T)
CNRD_Neoantigen <-
read.delim('./data-raw/Neoantigen_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
usethis::use_data(CNRD_Neoantigen,overwrite = T)
CNRD_Tcell <-
read.delim('./data-raw/tcell_full_v3_CNRD.csv',sep = ",",header = T,fill = T,comment.char = "")
usethis::use_data(CNRD_Tcell,overwrite = T)
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/CNRD_MHC_Ligand.rda")
View(CNRD_MHC_Ligand)
unique_Allele <- unique(CNRD_MHC_Ligand$MHC_Allele)
H2_Allele <- grep("H2", unique_Allele)
H2_Allele <- unique_Allele[grep("H2", unique_Allele)]
grep("H2", unique_Allele)
unique_Allele
H2_Allele
grep("H2-Q1",CNRD_MHC_Ligand$MHC_Allele)
grep("H2-Q2",CNRD_MHC_Ligand$MHC_Allele)
sum(grep("H2-Q2",CNRD_MHC_Ligand$MHC_Allele))
grep("H2-Q9",CNRD_MHC_Ligand$MHC_Allele)
unique_Allele
RT1_Allle <- unique_Allele[grep("RT1-",unique_Allele)]
RT1_Allle
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/IEDB_MHC_Ligand.rda")
View(IEDB_MHC_Ligand)
load("~/Documents/01-Work/04-Neonatigen/neoantigenproject/data/CNRD_Tcell.rda")
View(CNRD_Tcell)
unique(CNRD_Tcell$Relation)
library(dplyr)
Non_Epitope <- CNRD_Tcell %>% filter(Relation != "Epitope")
View(Non_Epitope)
unique(Non_Epitope$Epitope_Organism)
View(CNRD_MHC_Ligand)
seq_test <- CNRD_MHC_Ligand$Peptide
seq_test <- CNRD_MHC_Ligand$Peptide[1:3000]
seq_test <- CNRD_MHC_Ligand$Peptide[1:300]
write(seq_test, file = "/Users/yujijun/Desktop/test_seq.txt")
CNRD_MHC_Ligand$Peptide[1:300]
write(t(seq_test), file = "/Users/yujijun/Desktop/test_seq.txt")
write(t(as.character(seq_test)), file = "/Users/yujijun/Desktop/test_seq.txt")
seq_test <- CNRD_MHC_Ligand$Peptide[1:3000]
write(t(as.character(unique(seq_test))), file = "/Users/yujijun/Desktop/test_seq.txt")
writeFASTA(t(as.character(unique(seq_test))), file = "/Users/yujijun/Desktop/test_seq.txt", compress = FALSE)
library(seqinr)
write.fasta(t(as.character(unique(seq_test))), file = "/Users/yujijun/Desktop/test_seq.txt", compress = FALSE)
write.fasta(t(as.character(unique(seq_test))), file = "/Users/yujijun/Desktop/test_seq.txt")
length(t(as.character(unique(seq_test))))
names <- paste("name",seq(1,1187))
write.fasta(sequences = t(as.character(unique(seq_test))),names = names file = "/Users/yujijun/Desktop/test_seq.txt")
write.fasta(sequences = t(as.character(unique(seq_test))),names = names, file = "/Users/yujijun/Desktop/test_seq.txt")
write.fasta(sequences = t(as.character(unique(seq_test))),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
write.fasta()
?write.fasta
write.fasta(sequences = as.character(unique(seq_test)),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
is.vector(as.character(unique(seq_test)))
as.character(unique(seq_test))
names <- paste("name",seq(1,1187),sep = "_")
write.fasta(sequences = as.vector(unique(seq_test)),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
write.fasta(c("AAA", "CCC"), names=c("a", "b"), file.out="/Users/yujijun/Desktop/foo.fa")
write.fasta(sequences = as.list(unique(seq_test)),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
seq <- unique(seq_test)
seq <- seq[-grep("+",seq)]
seq <- unique(seq_test)
seq <- seq[-grep("+",seq)]
head(seq)
seq <- as.factor(unique(seq_test))
seq <- as.list(unique(seq_test))
seq <- as.character(unique(seq_test))
seq <- seq[-grep("+",seq)]
seq <- as.character(unique(seq_test))
seq <- seq[-grep("[+]",seq)]
names <- paste("name",seq(1,1148),sep = "_")
write.fasta(sequences = as.list(seq),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
length(seq)
library(seqinr)
seq <- as.character(unique(seq_test))
seq <- seq[-grep("[+]",seq)]
names <- paste("name",seq(1,1148),sep = "_")
write.fasta(sequences = as.list(seq),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
sapply(seq, length)
library(stringi)
library(stringr)
sapply(seq, str_length)
seq <- seq[sapply(seq, str_length) > 8]
names <- paste("name",seq(1,1088),sep = "_")
write.fasta(sequences = as.list(seq),names = names, file.out = "/Users/yujijun/Desktop/test_seq.txt")
getwd()
odd.pep.path <- "./data_project/Odd-peptide/"
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
View(CancerPPD)
length("gfgmalkllkkvl")
library(stringr)
library(stringr)
library(stringi)
str_length("gfgmalkllkkvl")
str_length("rrrrrrrrGNLWAAQRYGRELRRMSDEFVDSFKK")
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
?add_column
add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = Peptide)
add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = "Peptide")
View(CancerPPD_new)
str_length("rrrrrrrrGEDIIRNIARHAAQVGASMDR")
str_length("rrrrrrrrGNLWAAQRYGRELRRMSDEFVDSFKK")
grep("-",CancerPPD_new$Peptide)
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide),] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide),] <- rep("Other",length(grep("-",CancerPPD_new$Peptide))
)
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
grep("[*]",CancerPPD_new$Peptide)
CancerPPD_new$Peptide_change[grep("rrrrr",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
str_to_upper(CancerPPD_new$Peptide[CancerPPD_new$Peptide_change == "change"])
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
CancerPPD_new$Peptide[CancerPPD_new$Peptide_change == "change"] = str_to_upper(CancerPPD_new$Peptide[CancerPPD_new$Peptide_change == "change"])
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide[CancerPPD_new$Peptide_change == "change"] = str_to_upper(CancerPPD_new$Peptide[CancerPPD_new$Peptide_change == "change"])
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- rep("Other",length(grep("-",CancerPPD_new$Peptide)))
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)]
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)]
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)]
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)]
grep("lw",CancerPPD_new$Peptide
)
CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)]
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_class = c(rep("Other",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)]
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_class = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_class[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_change[grep("*",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("*",CancerPPD_new$Peptide)] <- "Other"
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_class = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("*",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("*",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("*",CancerPPD_new$Peptide)] <- "Other"
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"))
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_class = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)])
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_class = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_Type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_class[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_Type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
library(tibble)
odd.pep.path <- "./data_project/Odd-peptide"
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_Type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$Peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$Peptide_Type[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
library(stringi)
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
library(stringr)
CancerPPD_new$Peptide_change[grep("change",CancerPPD_new$Peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$Peptide_change)]))
write.csv(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.csv")
View(CancerPPD_new)
write.csv(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.csv",quote = F,col.names = T, row.names = F)
write.csv(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.csv",quote = F,col.names = T, row.names = F)
mhc_ligand <- read.csv(paste(odd.pep.path,"mhc_ligand_full_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
mhc_ligand <- read.csv(paste(odd.pep.path,"mhc_ligand_full_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
mhc_ligand_new <- add_column(mhc_ligand, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_Type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
library(tibble)
mhc_ligand_new <- add_column(mhc_ligand, Peptide_change = c(rep("change",nrow(CancerPPD))),Peptide_Type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
mhc_ligand_new <- add_column(mhc_ligand, Peptide_change = c(rep("change",nrow(mhc_ligand))),Peptide_Type = c(rep("No_change",nrow(mhc_ligand))),.after = "Peptide")
View(mhc_ligand)
mhc_ligand_new <- add_column(mhc_ligand, Peptide_change = c(rep("change",nrow(mhc_ligand))),Peptide_Type = c(rep("No_change",nrow(mhc_ligand))),.after = "Epitope_Description")
View(mhc_ligand_new)
dim(mhc_ligand_new)
str_split_fixed("[+]",mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),])[1]
mhc_ligand_new$Peptide_change[grep("[+]",mhc_ligand_new$Epitope_Description), ] <-
str_split_fixed("[+]",mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),],n = 2)[1]
str_split_fixed("[+]",mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),],n = 2)[1]
str_split_fixed("[+]",mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),],n = 2)
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),],"[+]",n = 2)[1]
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description),],"[+]",n = 2)
mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)]
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)],"[+]",n = 2)
mhc_ligand_new$Peptide_change[grep("[+]",mhc_ligand_new$Epitope_Description), ] <-
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)],"[+]",n = 2)[,1]
mhc_ligand_new$Peptide_change[grep("[+]",mhc_ligand_new$Epitope_Description)] <-
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)],"[+]",n = 2)[,1]
View(mhc_ligand_new)
mhc_ligand_new$Peptide_change[mhc_ligand_new$Peptide_change == "change"] = mhc_ligand_new$Epitope_Description[mhc_ligand_new$Peptide_change == "change"]
View(mhc_ligand_new)
View(mhc_ligand_new)
mhc_ligand <- read.csv(paste(odd.pep.path,"mhc_ligand_full_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
mhc_ligand_new <- add_column(mhc_ligand, Peptide_change = c(rep("change",nrow(mhc_ligand))),Peptide_Type = c(rep("No_change",nrow(mhc_ligand))),.after = "Epitope_Description")
mhc_ligand_new$Peptide_change[grep("[+]",mhc_ligand_new$Epitope_Description)] <-
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)],"[+]",n = 2)[,1]
View(mhc_ligand_new)
mhc_ligand_new$Peptide_Type[mhc_ligand_new$Peptide_change == "change"] = "other"
View(mhc_ligand_new)
mhc_ligand_new$Peptide_change[mhc_ligand_new$Peptide_change == "change"] = mhc_ligand_new$Epitope_Description[mhc_ligand_new$Peptide_change == "change"]
View(mhc_ligand_new)
xaringan:::inf_mr()
View(CancerPPD_new)
write.csv(mhc_ligand_new,file = "./data_project/Odd-peptide/mhc_ligand_full_select_col.csvstrange_peptide_v2.csv",quote = F,col.names = T, row.names = F)
write.csv(mhc_ligand_new,file = "./data_project/Odd-peptide/mhc_ligand_full_select_col.csvstrange_peptide_v2.csv",quote = F, row.names = F)
#tcell_full
tcell <- read.csv(paste(odd.pep.path,"tcell_full_v3_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
dim(tcell)
View(tcell)
#CancerPPD dataset
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, peptide_change = c(rep("change",nrow(CancerPPD))),peptide_type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("change",CancerPPD_new$peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$peptide_change)]))
write.csv(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.csv",quote = F,col.names = T, row.names = F)
#CancerPPD dataset
CancerPPD <- read.csv(paste(odd.pep.path,"CancerPPD_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
CancerPPD_new <- add_column(CancerPPD, peptide_change = c(rep("change",nrow(CancerPPD))),peptide_type = c(rep("No_change",nrow(CancerPPD))),.after = "Peptide")
CancerPPD_new$peptide_change[grep("lw",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("lw",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("lw",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("-",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("-",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("-",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("[*]",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("[*]",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("[*]",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("rrr",CancerPPD_new$Peptide)] <- as.character(CancerPPD_new$Peptide[grep("rrr",CancerPPD_new$Peptide)])
CancerPPD_new$peptide_type[grep("rrr",CancerPPD_new$Peptide)] <- "Other"
CancerPPD_new$peptide_change[grep("change",CancerPPD_new$peptide_change)] <- as.character(str_to_upper(CancerPPD_new$Peptide[grep("change",CancerPPD_new$peptide_change)]))
write.csv(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.csv",quote = F, row.names = F)
View(CancerPPD_new)
#mhc_ligand
mhc_ligand <- read.csv(paste(odd.pep.path,"mhc_ligand_full_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
mhc_ligand_new <- add_column(mhc_ligand, peptide_change = c(rep("change",nrow(mhc_ligand))),peptide_type = c(rep("No_change",nrow(mhc_ligand))),.after = "Epitope_Description")
mhc_ligand_new$peptide_change[grep("[+]",mhc_ligand_new$Epitope_Description)] <-
str_split_fixed(mhc_ligand_new$Epitope_Description[grep("[+]",mhc_ligand_new$Epitope_Description)],"[+]",n = 2)[,1]
mhc_ligand_new$peptide_type[mhc_ligand_new$peptide_change == "change"] = "other"
mhc_ligand_new$peptide_change[mhc_ligand_new$peptide_change == "change"] = mhc_ligand_new$Epitope_Description[mhc_ligand_new$peptide_change == "change"]
write.csv(mhc_ligand_new,file = "./data_project/Odd-peptide/mhc_ligand_full_select_col.csvstrange_peptide_v2.csv",quote = F, row.names = F)
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,"df_full_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F)
}
change_fun("mhc_ligand_full_select_col.csvstrange_peptide.csv","mhc_ligand_full_select_col.csvstrange_peptide_v3.csv")
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F)
}
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F)
}
change_fun("mhc_ligand_full_select_col.csvstrange_peptide.csv","mhc_ligand_full_select_col.csvstrange_peptide_v3.csv")
library(readr)
dataset <- read_csv(NULL)
View(dataset)
#tcell_full
tcell <- read.csv(paste(odd.pep.path,"tcell_full_v3_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
View(tcell)
change_fun("tcell_full_v3_select_col.csvstrange_peptide.csv","tcell_full_v3_select_col.csvstrange_peptide_v2.csv")
inputfilename <- "tcell_full_v3_select_col.csvstrange_peptide.csv"
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
View(df_new)
View(df_new)
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
write.table(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.table(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
}
change_fun("tcell_full_v3_select_col.csvstrange_peptide.csv","tcell_full_v3_select_col.csvstrange_peptide_v2.csv")
change_fun("tcell_full_v3_select_col.csvstrange_peptide.csv","tcell_full_v3_select_col.csvstrange_peptide_v2.tsv")
write.table(CancerPPD_new,file = "./data_project/Odd-peptide/CancerPPD_CNRD_strange_peptide_v2.tsv",quote = F, row.names = F,sep = "\t")
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F)
}
change_fun("mhc_ligand_full_select_col.csvstrange_peptide.csv","mhc_ligand_full_select_col.csvstrange_peptide_v2.tsv")
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.csv(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
}
change_fun("mhc_ligand_full_select_col.csvstrange_peptide.csv","mhc_ligand_full_select_col.csvstrange_peptide_v2.tsv")
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.table(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
}
change_fun("mhc_ligand_full_select_col.csvstrange_peptide.csv","mhc_ligand_full_select_col.csvstrange_peptide_v2.tsv")
tcell <- read.csv(paste(odd.pep.path,"tcell_full_v3_select_col.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
change_fun <- function(inputfilename,outputfilename){
df <- read.csv(paste(odd.pep.path,inputfilename,sep = "/"),stringsAsFactors = F)
df_new <- add_column(df, peptide_change = c(rep("change",nrow(df))),peptide_type = c(rep("No_change",nrow(df))),.after = "Epitope_Description")
df_new$peptide_change[grep("[+]",df_new$Epitope_Description)] <-
str_split_fixed(df_new$Epitope_Description[grep("[+]",df_new$Epitope_Description)],"[+]",n = 2)[,1]
df_new$peptide_type[df_new$peptide_change == "change"] = "other"
df_new$peptide_change[df_new$peptide_change == "change"] = df_new$Epitope_Description[df_new$peptide_change == "change"]
write.table(df_new,file = paste(odd.pep.path,outputfilename,sep = "/"),quote = F, row.names = F,sep = "\t")
}
change_fun("tcell_full_v3_select_col.csvstrange_peptide.csv","tcell_full_v3_select_col.csvstrange_peptide_v2.tsv")
#Neoantigen
neoantigen <- read.csv(paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
View(neoantigen)
copy_neo <- neoantigen
neoantigen <- add_column(neoantigen,peptide_change = c(rep("change",nrow(neoantigen))),peptide_type = c(rep("No_change",nrow(neoantigen)))
)
neoantigen <- add_column(neoantigen,peptide_change = c(rep("change",nrow(neoantigen))),peptide_type = c(rep("No_change",nrow(neoantigen))).after = "Peptide")
#Neoantigen
neoantigen <- read.csv(paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide.csv",sep = "/"),stringsAsFactors = F)
neoantigen <- add_column(neoantigen,peptide_change = c(rep("change",nrow(neoantigen))),peptide_type = c(rep("No_change",nrow(neoantigen))),.after = "Peptide")
copy_neo <- neoantigen
copy_neo <- neoantigen
neoantigen$peptide_change = gsub("(wW)","",neoantigen$Peptide)
View(neoantigen)
neoantigen$peptide_change = gsub("(\b)","",neoantigen$Peptide)
View(neoantigen)
neoantigen$peptide_change = gsub("\(\b\)","",neoantigen$Peptide)
neoantigen$peptide_change = gsub("\\(\w\\)","",neoantigen$Peptide)
neoantigen$peptide_change = gsub("\\([\w]\\)","",neoantigen$Peptide)
neoantigen$peptide_change = gsub("\\([\\w]\\)","",neoantigen$Peptide)
View(neoantigen)
View(neoantigen)
View(neoantigen)
?gsub
neoantigen$peptide_change = gsub("*\\(.*?\\)*","",neoantigen$Peptide)
View(neoantigen)
neoantigen$peptide_change = gsub(" *\\(.*?\\) *", "",neoantigen$Peptide)
View(neoantigen)
write.table(df_new,file = paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide_v2.csv",sep = "/"),quote = F, row.names = F,sep = "\t")
write.table(neoantigen,file = paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide_v2.csv",sep = "/"),quote = F, row.names = F,sep = "\t")
write.table(neoantigen,file = paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide_v2.tsv",sep = "/"),quote = F, row.names = F,sep = "\t")
write.table(neoantigen,file = paste(odd.pep.path,"Neoantigen_CNRD.csvstrange_peptide_v2.tsv",sep = "/"),quote = F, row.names = F,sep = "\t")
#TCGA
TCGA <- read.csv(paste(odd.pep.path,"TCGA_TCR_seq_CNRD_strange_peptide.csv",sep = "/"),stringsAsFactors = F)
View(TCGA)
