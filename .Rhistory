MHCII_2009 = read.table(list_file[1],header = F,row.names = NULL)
list_file = paste(basic_path, list_file)
list_file
MHCII_2009 = read.table(list_file[1],header = F,row.names = NULL)
list_file[1]
MHCII_2009 = read.table(list_file[1],header = F,row.names = NULL)
list_file = paste(basic_path, list_file,sep = "/")
MHCII_2009 = read.table(list_file[1],header = F,row.names = NULL)
#MHCII 2009
basic_path = "./data_project/MHCII_binding_prediction/original_data/MHCII_binding_2009/class_II_all_split_5cv"
list_file = list.files(basic_path,pattern = "*_random_0.txt")
list_file
basic_path
list_file = paste(basic_path, list_file,sep = "/")
list_file
MHCII_2009 = read.table(list_file[1],header = F,row.names = NULL)
View(MHCII_2009)
First = as.data.frame()
First = data.frame()
First = data.frame()
for(i in list_file[1:2]){
file = read.table(i, header=F, row.names = NULL)
Firsr = bind_rows(First,file)
print(dim(First))
}
First = data.frame()
for(i in list_file[1:2]){
file = read.table(i, header=F, row.names = NULL)
Firsr = rbind(First,file)
print(dim(First))
}
First = data.frame()
for(i in list_file[1:2]){
file = read.table(i, header=F, row.names = NULL)
Firsr = rbind(First,file)
print(dim(First))
}
First = data.frame()
for(i in list_file[1:2]){
file = read.table(i, header=F, row.names = NULL)
First = rbind(First,file)
print(dim(First))
}
First = data.frame()
for(i in list_file[1:2]){
file = read.table(i, header=F, row.names = NULL)
First = bind_rows(First,file)
print(dim(First))
}
First = data.frame()
for(i in list_file){
file = read.table(i, header=F, row.names = NULL)
First = bind_rows(First,file)
print(dim(First))
}
head(First)
unique(First$V2)
View(First)
head(First)
MHCII_2009 = MHCII_2009[,c("V1","V2","V5","V3","V6","V7")]
output_path = "./data_project/MHCII_binding_prediction/revision_data/"
write.table(MHCII_2009,file = paste(output_path,"benchmark_MHCII_2009.txt",sep="/"),quote = F,sep="\t",row.names = F)
####MHC_binding_2008####
basic_path = "./data_project/MHCII_binding_prediction/original_data/MHCII_binding_2008"
MHCII_2008_name = paste(basic_path,"H-2-IAb.txt",sep = "/")
MHCII_2008 = read.table(MHCII_2008_name,header = T,row.names = NULL)
#binding all matrix together
file_list = list.files(basic_path)
MHCII_file_name = paste(basic_path, file_list, sep="/")
for(i in MHCII_file_name[-1]){
file = read.table(i, header=T, row.names = NULL)
MHCII_2008 = bind_rows(MHCII_2008,file)
print(dim(MHCII_2008))
}
#Species
species = c(rep("mouse",sum(MHCII_2008$row.names == "H-2")),rep("human",length(grep("HLA",MHCII_2008$row.names))))
MHCII_2008$Species = species
#MHC_Allele
MHC_ALlele = paste(MHCII_2008$row.names, MHCII_2008$ALL_ALLELE,sep="-")
MHCII_2008$MHC_Allele = MHC_ALlele
MHC_ALlele = paste(MHCII_2008$row.names, MHCII_2008$ALL_ALLELE,sep="-")
MHCII_2008$MHC_Allele = MHC_ALlele
#Add Inequality
MHCII_2008$Inequality = "="
# change the column order of the matrix
MHCII_2008 = MHCII_2008[,c(6,7,4,3,8,5)]
#rename and output
colnames(MHCII_2008) = c("Species", "MHC_Allele","Peptide","Length","Inequality","Ic50")
output_path = "./data_project/MHCII_binding_prediction/revision_data/"
write.table(MHCII_2008,file=paste(output_path,"benchmark_MHCII_2008.txt",sep = "/"),sep = "\t",quote = F,row.names = F)
MHCII_2009 = MHCII_2009[,c("V1","V2","V5","V3","V6","V7")]
colnames(MHCII_2009) <- c("Species","MHC_Allele","Peptide","Length","Inequality","Ic50")
output_path = "./data_project/MHCII_binding_prediction/revision_data/"
write.table(MHCII_2009,file = paste(output_path,"benchmark_MHCII_2009.txt",sep="/"),quote = F,sep="\t",row.names = T)
unique(MHCII_2009$MHC_Allele)
#MHCII 2009
basic_path = "./data_project/MHCII_binding_prediction/original_data/MHCII_binding_2009/class_II_all_split_5cv"
list_file = list.files(basic_path,pattern = "*_random_0.txt")
list_file = paste(basic_path, list_file,sep = "/")
First = data.frame()
for(i in list_file){
file = read.table(i, header=F, row.names = NULL)
First = bind_rows(First,file)
print(dim(First))
}
MHCII_2009 = First[,c("V1","V2","V5","V3","V6","V7")]
colnames(MHCII_2009) <- c("Species","MHC_Allele","Peptide","Length","Inequality","Ic50")
output_path = "./data_project/MHCII_binding_prediction/revision_data/"
write.table(MHCII_2009,file = paste(output_path,"benchmark_MHCII_2009.txt",sep="/"),quote = F,sep="\t",row.names = T)
dim(MHCII_2009)
unique(MHCII_2009$MHC_Allele)
1- log(50)/log(50000)
?log
e=exp(1)
e
1- log(50,base = exp(1))/log(50000,base = exp(1))
log(10)
exp(2)
exp(log(10))
#MHCII 2016
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_bind_NetMHCIIPan_32_2016"
list_file = list.files(basic_path)
list_file
list_file = paste(basic_path,c("test1","train1")
list_file = paste(basic_path,c("test1","train1"))
list_file = paste(basic_path,c("test1","train1"))
list_file
list_file = paste(basic_path,c("test1","train1"),sep = "/")
list_file
file = read.table(i,header = F,row.names = NULL)
Empty = data.frame()
for(i in list_file){
file = read.table(i,header = F,row.names = NULL)
Empty = bind_rows(Empty,file)
print(dim(Empty))
}
head(Empty)
mutate(Empty,Ic50 = exp((1-V2)*log(50000)))
Empty$Species = "human/mouse"
Empty$Species[grep("HLA-",Empty$V3),] = "human"
Empty$Species[grep("HLA-",Empty$V3),] = rep("human",length(rep("HLA-",Empty$V3)))
Empty$Species[grep("HLA-",Empty$V3),] = rep("human",length(grep("HLA-",Empty$V3)))
length(grep("HLA-",Empty$V3))
rep("human",length(grep("HLA-",Empty$V3)))
length(Empty$Species[grep("HLA-",Empty$V3),] )
grep("HLA-",Empty$V3)
Empty$Species[grep("HLA-",Empty$V3)] = rep("human",length(grep("HLA-",Empty$V3)))
unique(Empty$V3)
#HLA Allele
gsub("^DR","HLA-DR",Empty$V3)
#HLA Allele
Empty$V3 = gsub("^DR","HLA-DR",Empty$V3)
unique(Empty$V3)
unique(MHCII_2009$MHC_Allele)
MHCII_allele = Empty$V3
is.vector(MHCII_allele)
allele = Empty$V3
rm(list = MHC_ALlele)
# --------------
# Date:  2019-10-30 17:21:50
# Author:JijunYu
# Email: jijunyu140@gmail.com
# --------------
# About project:This is for MHCII_preprocessing and statistic
#
require(dplyr)
require(stringi)
require(stringr)
allele = str_split_fixed(allele)
allele = gsub("_","*",allele)
allele = str_split_fixed(allele,pattern = "-")
unique(allele)
allele = gsub("HLA-DPA1","HLA-DPA1*",allele)
unique(allele)
allele = gsub("HLA-DQA1","HLA-DQA1*",allele)
unique(allele)
allele = gsub("-DPB1","-DPB1*",allele)
allele = gsub("-DQB1","-DQB1*",allele)
unique(allele)
Empty$V3 = gsub("^DR","HLA-DR",Empty$V3)
allele = Empty$V3
allele = gsub("_","*",allele)
allele = gsub("HLA-DPA1","HLA-DPA1*",allele)
allele = gsub("HLA-DQA1","HLA-DQA1*",allele)
allele = gsub("-DPB1","/DPB1*",allele)
allele = gsub("-DQB1","/DQB1*",allele)
allele = str_split_fixed(allele,pattern = "-")
unique(allele)
Empty$V3 = allele
Empty$Species = "human/mouse"
Empty$Species[grep("HLA-",Empty$V3)] = rep("human",length(grep("HLA-",Empty$V3)))
Empty$Species[!grep("HLA-",Empty$V3)] = rep("mouse",length(grep("HLA-",Empty$V3)))
View(Empty)
#MHCII 2016
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_bind_NetMHCIIPan_32_2016"
list_file = list.files(basic_path)
list_file = paste(basic_path,c("test1","train1"),sep = "/")
Empty = data.frame()
for(i in list_file){
file = read.table(i,header = F,row.names = NULL)
Empty = bind_rows(Empty,file)
print(dim(Empty))
}
mutate(Empty,Ic50 = exp((1-V2)*log(50000))) #calculate Ic50 by inverse function
Empty = mutate(Empty,Ic50 = exp((1-V2)*log(50000))) #calculate Ic50 by inverse function
#HLA Allele
Empty$V3 = gsub("^DR","HLA-DR",Empty$V3)
allele = Empty$V3
allele = gsub("_","*",allele)
allele = gsub("HLA-DPA1","HLA-DPA1*",allele)
allele = gsub("HLA-DQA1","HLA-DQA1*",allele)
allele = gsub("-DPB1","/DPB1*",allele)
allele = gsub("-DQB1","/DQB1*",allele)
Empty$V3 = allele
Empty$Species = "human/mouse"
Empty$Species[grep("HLA-",Empty$V3)] = rep("human",length(grep("HLA-",Empty$V3)))
Empty$Species[!grep("HLA-",Empty$V3)] = rep("mouse",length(grep("HLA-",Empty$V3)))
nchar(Empty$V1)
Empty$Length = nchar(Empty$V1)
Empty$Inequality = "="
head(Empty)
Empty = Empty[,c("Species","V3","V1","Length","Inequality","Ic50")]
colnames(Empty) = c("Species","MHC_Allele","Peptide","Length","Inequality","Ic50")
View(Empty)
output_path = "./data_project/MHCII_binding_prediction/revision_data/"
write.table(MHCII_2009,file = paste(output_path,"benchmark_MHCII_2016.txt",sep="/"),quote = F,sep="\t",row.names = T)
write.table(Empty,file = paste(output_path,"benchmark_MHCII_2016.txt",sep="/"),quote = F,sep="\t",row.names = T)
write.table(Empty,file = paste(output_path,"benchmark_MHCII_2016.txt",sep="/"),quote = F,sep="\t",row.names = F)
write.table(MHCII_2009,file = paste(output_path,"benchmark_MHCII_2009.txt",sep="/"),quote = F,sep="\t",row.names = F)
#MHCII 2018
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv"),sep = "/"),header=F,row.names=NULL)
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=F,row.names=NULL)
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=F,row.names=NULL,skipNul = T)
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=F,row.names=NULL,fill=T)
View(file_input)
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
allele =file_input$allele
unique(allele)
allele = gsub(":","",allele)
unique(allele)
which(allele == "")
file_input = file_input[!which(allele == ""),]
file_input = file_input[!which(allele == ""),] #delete empty column
file_input[which(allele == "+"),]
which(allele == "+")
input_file[504,]
file_input[504,]
file_input[!which(allele == ""),]
file_input = file_input[which(allele == "+"),]
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
allele =file_input$allele
allele = gsub(":","",allele)
file_input = file_input[!which(allele == ""),] #delete empty column
file_input = file_input[!which(allele == "+"),]
head(file_input)
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
allele =file_input$allele
allele = gsub(":","",allele)
dim(file_input)
!which(allele == "")
allele =file_input$allele
allele = gsub(":","",allele)
length(allele)
which(allele == "")
file_input = file_input[-which(allele == ""),] #delete empty column
dim(file_input)
file_input = file_input[-which(allele == "+"),]
dim(file_input)
#MHCII 2018
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
file_input[c(504,505),]
unique(allele)
file_input = file_input[-which(allele == "+"),]
allele =file_input$allele
allele = gsub(":","",allele)
unique(allele)
#MHCII 2018
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
file_input = file_input[-which(allele == ""),] #delete empty column
file_input = file_input[-which(allele == "+"),]
allele =file_input$allele
allele = gsub(":","",allele)
unique(allele)
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
file_input = file_input[-which(allele == ""),] #delete empty column
file_input = file_input[-which(allele == "+"),]
dim(file_input)
#MHCII 2018
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
file_input = file_input[-which(allele == ""),] #delete empty column
dim(file_input)
which(allele == "")
#MHCII 2018
basic_path = "/Users/yujijun/Documents/01-Work/04-Neonatigen/neoantigenproject/data_project/MHCII_binding_prediction/original_data/MHCII_initial_benchmark_2018"
#MHCII_initial_benchmark_datasets.txt
file_input = read.table(paste(basic_path,"MHCII_initial_benchmark_datasets.tsv",sep = "/"),header=T,row.names=NULL,fill=T)
unique(file_input$allele)
which(file_input$allele == "")
file_input = file_input[-which(file_input$allele == ""),] #delete empty column
file_input = file_input[-which(file_input$allele == "+"),]
dim(file_input)
allele =file_input$allele
allele = gsub(":","",allele)
unique(allele)
allele = gsub("H2","H-2",allele)
unique(allele)
file_input$Species = "NULL"
grep("H-2",allele)
file_input$Species[grep("H-2",allele)] = "mouse"
file_input$Species[grep("HLA-",allele)] = "human"
file_input$length = nchar(file_input$peptide_sequence)
file_input$peptide_sequence
file_input$length = nchar(as.vector(file_input$peptide_sequence))
file_input$Inequality = "="
file_input$measurement_type == "binary"
sum(file_input$measurement_type == "binary")
head(file_input)
file_input_binary = file_input[which(file_input$measurement_type == "binary"),]
file_input_binary = file_input[-which(file_input$measurement_type == "binary"),]
r
r
file_input_binary = file_input[which(file_input$measurement_type == "binary"),]
file_input_ic50 = file_input[-which(file_input$measurement_type == "binary"),]
file_input_ic50 = file_input_ic50[,c(7,4,3,8,9,5)]
View(file_input_ic50)
colnames(file_input_ic50) = c("Species","MHC_Allele","Peptide","Length","Inequality","Ic50")
View(file_input_binary)
headfile_input_binary)
head(file_input_binary)
file_input_binary = file_input_binary[,c(7,4,3,8,5,6)]
colnames(file_input_binary) = c("Species","MHC_Allele","Peptide","Length","Measure_value","Measure_Type")
write.table(file_input_ic50,file = paste(output_path,"benchmark_MHCII_2018_ic50.txt",sep="/"),quote = F,sep="\t",row.names = F)
write.table(file_input_binary,file = paste(output_path,"benchmark_MHCII_2018_binary.txt",sep="/"),quote = F,sep="\t",row.names = F)
require(dplyr)
require(readtext)
require(stringi)
require(stringr)
require(seqinr)
basic_path = "./data_project/MHCI_binding_prediction/original_data/"
file_list = list.files(basic_path)
file_list
basic_path = "./data_project/MHCI_binding_prediction/revision_data/"
file_list = list.files(basic_path)
file_list
####input data####
benchmark_MHCI_2006 <- read.table(paste(basic_path,"benchmark_MHCI_2006.txt",sep = "/"),row.names = NULL,header = T)
View(benchmark_MHCI_2006)
require(dplyr)
require(readtext)
require(stringi)
require(stringr)
require(seqinr)
require(tibble)
benchmark_MHCI_2006$MHC_Type
unique(benchmark_MHCI_2006$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(.after =1 MHC_Type = MHC_Type)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.after =1 )
View(benchmark_MHCI_2006)
benchmark_MHCI_2006 <- read.table(paste(basic_path,"benchmark_MHCI_2006.txt",sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.after =1,.before=3)
unique(MHC_Type)
####input data####
benchmark_MHCI_2006 <- read.table(paste(basic_path,"benchmark_MHCI_2006.txt",sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.after =1,.before=3)
benchmark_MHCI_2006 <- read.table(paste(basic_path,"benchmark_MHCI_2006.txt",sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2)
View(benchmark_MHCI_2006)
dim(benchmark_MHCI_2006)
head(benchmark_MHCI_2006)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2,w=0)
benchmark_MHCI_2006$MHC_Type <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2)
benchmark_MHCI_2006 <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2)
basic_path = "./data_project/MHCI_binding_prediction/revision_data/"
file_list = list.files(basic_path)
####input data####
benchmark_MHCI_2006 <- read.table(paste(basic_path,"benchmark_MHCI_2006.txt",sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006 <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2)
View(benchmark_MHCI_2006)
unique(benchmark_MHCI_2006)
file_list
basic_path = "./data_project/MHCI_binding_prediction/revision_data/"
file_list = list.files(basic_path)
file_list
benchmark_MHCI_2009 <- read.table(paste(basic_path,file_list[6],sep = "/"),row.names = NULL,header = T)
View(benchmark_MHCI_2009)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2009$MHC_Allele)
benchmark_MHCI_2009 <- benchmark_MHCI_2009 %>% add_column(MHC_Type = MHC_Type,.before=2)
benchmark_MHCI_2009 <- benchmark_MHCI_2009[,-6]
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
View(benchmark_MHCI_2013)
unique(benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2009 <- read.table(paste(basic_path,file_list[6],sep = "/"),row.names = NULL,header = T)
View(benchmark_MHCI_2013)
View(benchmark_MHCI_2009)
unique(benchmark_MHCI_2009$MHC_Allele)
benchmark_MHCI_2009$MHC_Allele <- gsub("ELA-A*1","ELA-A1", benchmark_MHCI_2009$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2009$MHC_Allele)
unique(MHC_Type)
benchmark_MHCI_2009 <- read.table(paste(basic_path,file_list[6],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2009$MHC_Allele <- gsub("ELA-A*1","ELA-A1", benchmark_MHCI_2009$MHC_Allele)
View(benchmark_MHCI_2009)
benchmark_MHCI_2009$MHC_Allele <- gsub("ELA-A[*]1","ELA-A1", benchmark_MHCI_2009$MHC_Allele)
View(benchmark_MHCI_2009)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2009$MHC_Allele)
unique(MHC_Type)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2009$MHC_Allele)
benchmark_MHCI_2009 <- benchmark_MHCI_2009 %>% add_column(MHC_Type = MHC_Type,.before=2)
benchmark_MHCI_2009 <- benchmark_MHCI_2009[,-6]
View(benchmark_MHCI_2009)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
View(benchmark_MHCI_2013)
unique(benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
unique(MHC_Type)
benchmark_MHCI_2013 <- benchmark_MHCI_2013 %>% add_column(MHC_Type = MHC_Type,.before=2)
output_path <- "./data_project/MHCI_binding_prediction/revision_data/"
write.table(benchmark_MHCI_2006, file=paste(output_path, "benchmark_MHCI_2006.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
benchmark_MHCI_2006 <- read.table(paste(basic_path,file_list[3],sep = "/"),row.names = NULL,header = T)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2006$MHC_Allele)
benchmark_MHCI_2006 <- benchmark_MHCI_2006 %>% add_column(MHC_Type = MHC_Type,.before=2)
output_path <- "./data_project/MHCI_binding_prediction/revision_data/"
write.table(benchmark_MHCI_2006, file=paste(output_path, "benchmark_MHCI_2006.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
write.table(benchmark_MHCI_2009, file=paste(output_path, "benchmark_MHCI_2009.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
write.table(benchmark_MHCI_2013, file=paste(output_path, "benchmark_MHCI_2013.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A[*]0311",benchmark_MHCI_2013$MHC_Allele)
unique(benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
unique(benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
unique(MHC_Type)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
unique(MHC_Type)
unique(benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- benchmark_MHCI_2013 %>% add_column(MHC_Type = MHC_Type,.before=2)
write.table(benchmark_MHCI_2013, file=paste(output_path, "benchmark_MHCI_2013.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- benchmark_MHCI_2013 %>% add_column(MHC_Type = MHC_Type,.before=2)
benchmark_MHCI_2013$MHC_Type <- MHC_Type
write.table(benchmark_MHCI_2013, file=paste(output_path, "benchmark_MHCI_2013.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
unique(benchmark_MHCI_2013$MHC_Type)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Type <- MHC_Type
unique(benchmark_MHCI_2013$MHC_Type)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw[**]","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Type <- MHC_Type
unique(benchmark_MHCI_2013$MHC_Type)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw[**]","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Type <- MHC_Type
unique(benchmark_MHCI_2013$MHC_Type)
unique(benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw[**]","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
unique(benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw[*][*]","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
unique(benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
benchmark_MHCI_2013$MHC_Type <- MHC_Type
write.table(benchmark_MHCI_2013, file=paste(output_path, "benchmark_MHCI_2013.txt",sep = "/"),quote = F,sep = "\t",row.names = F)
benchmark_MHCI_2013 <- read.table(paste(basic_path,file_list[9],sep = "/"),row.names = NULL,header = T)
benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-A[*]03[/]11","HLA-A*0311",benchmark_MHCI_2013$MHC_Allele)
#benchmark_MHCI_2013$MHC_Allele <- gsub("HLA-Cw[*][*]","HLA-Cw*",benchmark_MHCI_2013$MHC_Allele)
MHC_Type <- gsub("[*][0-9a-zA-Z]+","",benchmark_MHCI_2013$MHC_Allele)
unique(benchmark_MHCI_2013$MHC_Allele)
unique(MHC_Type)
unique(benchmark_MHCI_2013$Species)
x <- "GSIGAASMEFCFDVFKELKVHHANENIFYCPIAIMSALAMVYLGAKDSTRTQINKVVRFD KLPGFGDSIEAQCGTSVNVHSSLRDILNQITKPNDVYSFSLASRLYAEERYPILPEYLQC VKELYRGGLEPINFQTAADQARELINSWVESQTNGIIRNVLQPSSVDSQTAMVLVNAIVF KGLWEKAFKDEDTQAMPFRVTEQESKPVQMMYQIGLFRVASMASEKMKILELPFASGTMS MLVLLPDEVSGLEQLESIINFEKLTEWTSSNVMEERKIKVYLPRMKMEEKYNLTSVLMAMGITDVFSSSANLSGISSAESLKISQAVHAAHAEINEAGREVVGSAEAGVDAASVSEEFRADHPFLFCIKHIATNAVLFFGRCVSP"
length(x)
str_length(x)
